"use strict";function changeProfile(){$("#file").trigger("click")}if($(".main-content").find("#user-profile").length){function addOrUpdateQrCode(){let user_id=$("#user_id").val();$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/qr-code/add-or-update",dataType:"json",data:{user_id:user_id},beforeSend:function(){swal(pleaseWaitText,loadingText,{closeOnClickOutside:!1,closeOnEsc:!1,buttons:!1,timer:2e3})}}).done((function(response){response.status&&$(".user-profile-qr-code").html(`<img src="https://api.qrserver.com/v1/create-qr-code/?data=${response.secret}&amp;size=200x200"/>`)})).fail((function(error){swal({title:errorText,text:JSON.parse(error.responseText).exception,icon:"error",closeOnClickOutside:!1,closeOnEsc:!1})}))}function upload(img){var form_data=new FormData;form_data.append("file",img.files[0]),form_data.append("_token",csrfToken),$("#loading").css("display","block"),$.ajax({url:profileImageUploadUrl,data:form_data,type:"POST",contentType:!1,processData:!1,cache:!1,success:function(data){data.fail?$("#file-error").show().addClass("error").html(data.errors.file).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}):($("#file-error").hide(),$("#file_name").val(data),$("#profileImage").attr("src",profileImageSourceUrl+"/"+data),$("#profileImageHeader").attr("src",profileImageSourceUrl+"/"+data),$("#profileImageHeaderdrop").attr("src",profileImageSourceUrl+"/"+data),location.reload()),$("#loading").css("display","none")},error:function(xhr,status,error){}})}$(document).on("click","#print-qr-code-btn",(function(e){e.preventDefault();let printQrCodeUrl=SITE_URL+"/profile/qr-code-print/"+userId+"/user";$(this).attr("href",printQrCodeUrl),window.open($(this).attr("href"),"_blank")})),$(window).on("load",(function(){swal(pleaseWaitText,loadingText,{closeOnClickOutside:!1,closeOnEsc:!1,buttons:!1,timer:2e3}),""!=QrCodeSecret?($(".user-profile-qr-code").html(`<img src="https://api.qrserver.com/v1/create-qr-code/?data=${QrCodeSecret}&amp;size=200x200"/>`),$("#qr-code-btn").removeClass("add-qr-code").addClass("update-qr-code").text(updateQrCodeText),$("#print-qr-code-btn").show()):($(".user-profile-qr-code").html(`<img class="" src="${SITE_URL}/public/uploads/userPic/default-image.png" class="img-responsive"/>`),$("#qr-code-btn").addClass("add-qr-code").text(addQrCodeText))})),$(document).on("click",".update-qr-code",(function(e){e.preventDefault(),addOrUpdateQrCode()})),$(document).on("click",".add-qr-code",(function(e){e.preventDefault(),addOrUpdateQrCode(),$("#qr-code-btn").removeClass("add-qr-code").addClass("update-qr-code").text(updateQrCodeText)})),$("#add").on("hidden.bs.modal",(function(){""!=$("#phone").val()&&($(this).find("input").val("").end(),$("#complete-phone-verification").validate().resetForm(),window.location.reload())})),$(document).ready((function(){$("#phone").intlTelInput({separateDialCode:!0,nationalMode:!0,preferredCountries:[countryShortCode],autoPlaceholder:"polite",placeholderNumberType:"MOBILE",utilsScript:utilsScriptLoadingPath}),$("#phone").on("countrychange",(function(){if($("#defaultCountry").val($("#phone").intlTelInput("getSelectedCountryData").iso2),$("#carrierCode").val($("#phone").intlTelInput("getSelectedCountryData").dialCode),$.trim($(this).val()))if($(this).intlTelInput("isValidNumber")&&isValidPhoneNumber($.trim($(this).val()))){$("#tel-number-error").html("");var id=$("#id").val();$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/duplicate-phone-number-check",dataType:"json",cache:!1,data:{phone:$.trim($(this).val()),carrierCode:$.trim($("#phone").intlTelInput("getSelectedCountryData").dialCode),id:id}}).done((function(response){response.status?($("#tel-number-error").html(""),$("#phone-number-error").show(),$("#phone-number-error").addClass("error").html(response.fail).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),$("#common_button").prop("disabled",!0)):($("#tel-number-error").show(),$("#phone-number-error").html(""),$("#common_button").prop("disabled",!1))}))}else $("#tel-number-error").addClass("error").html(validPhoneNumberErrorText).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),$("#common_button").prop("disabled",!0),$("#phone-number-error").hide();else $("#tel-number-error").html(""),$("#phone-number-error").html(""),$("#common_button").prop("disabled",!1)}))})),$(document).ready((function(){$("#phone").on("blur",(function(e){if($.trim($(this).val()))if($(this).intlTelInput("isValidNumber")&&isValidPhoneNumber($.trim($(this).val()))){var id=$("#id").val(),phone=$(this).val().replace(/-|\s/g,""),phone=$(this).val().replace(/^0+/,""),pluginCarrierCode=$("#phone").intlTelInput("getSelectedCountryData").dialCode;0==phone.length?($("#phone-number-error").addClass("error").html(fieldRequiredText).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),$("#common_button").prop("disabled",!0)):($("#phone-number-error").hide(),$("#common_button").prop("disabled",!1)),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/duplicate-phone-number-check",dataType:"json",cache:!1,data:{phone:phone,id:id,carrierCode:pluginCarrierCode}}).done((function(response){$("#phone-number-error").show(),response.status?0==phone.length?$("#phone-number-error").html(""):($("#phone-number-error").addClass("error").html(response.fail).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),$("#common_button").prop("disabled",!0)):($("#common_button").prop("disabled",!1),$("#phone-number-error").html(""))})),$("#tel-number-error").html(""),$("#phone-number-error").show(),$("#common_button").prop("disabled",!1)}else $("#tel-number-error").addClass("error").html(validPhoneNumberErrorText).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),$("#common_button").prop("disabled",!0),$("#phone-number-error").hide();else $("#tel-number-error").html(""),$("#phone-number-error").html(""),$("#common_button").prop("disabled",!1)}))})),$(document).ready((function(){var is_sms_env_enabled=$("#is_sms_env_enabled").val(),checkPhoneVerification=$("#checkPhoneVerification").val();!is_sms_env_enabled&&"Enabled"!=checkPhoneVerification||"Enabled"!=checkPhoneVerification?$(".next").removeClass("next").addClass("form_submit").html(submitText):$(".next").removeClass("form_submit").addClass("next").html(nextText)})),$(document).on("click",".next",(function(){var phone=$("input[name=phone]");if(""==phone.val())return $("#phone-number-error").addClass("error").html(fieldRequiredText).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),!1;if(phone.hasClass("error"))return!1;$(".modal-title").html(getCodeText),$("#subheader_text").html(verificationCodeText),$(".phone_group").hide(),$("#static_phone_show").show(),$(".edit").show(),$(this).removeClass("next").addClass("get_code").html(getCodeText);var fullPhone=$("#phone").intlTelInput("getNumber");return $("#static_phone_show").html(fullPhone+"&nbsp;&nbsp;"),!0})),$(document).on("click",".edit",(function(){$(".get_code").removeClass("get_code").addClass("next").html(nextText),$(".static_phone_show").html(""),$(this).hide(),$("#subheader_text").html(phoneNumberText),$(".phone_group").show()})),$(document).on("click",".get_code",(function(){$(".modal-title").html(verifyPhoneText),$(".phone_group").hide(),$(".static_phone_show").html(""),$("#subheader_text").html(smsCodeSentText+"<br><br>"+smsCodeSubmitText),$("#subheader_text").html(smsCodeSentText+"<br><br>"+smsCodeSubmitText),$(".edit").hide(),$("#phone_verification_code").show().val(""),$(this).removeClass("get_code").addClass("verify").html(verifyText);var pluginCarrierCode=$("#phone").intlTelInput("getSelectedCountryData").dialCode,pluginPhone=$("#phone").intlTelInput("getNumber");$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/getVerificationCode",dataType:"json",cache:!1,data:{phone:pluginPhone,carrierCode:pluginCarrierCode}}).done((function(response){response.status&&$("#hasVerificationCode").val(response.message)}))})),$(document).on("click",".verify",(function(){var classOfSubmit=$("#common_button"),phone_verification_code=$("#phone_verification_code").val(),pluginPhone=$("#phone").intlTelInput("getNumber"),pluginCarrierCode=$("#phone").intlTelInput("getSelectedCountryData").dialCode,pluginDefaultCountry=$("#phone").intlTelInput("getSelectedCountryData").iso2;classOfSubmit.hasClass("verify")&&$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/complete-phone-verification",dataType:"json",cache:!1,data:{phone:pluginPhone,defaultCountry:pluginDefaultCountry,carrierCode:pluginCarrierCode,phone_verification_code:phone_verification_code}}).done((function(data){data.status&&500!=data.status?($("#message").removeClass("alert-danger"),$("#message").css("display","block"),$("#message").html(data.message),$("#message").addClass(data.success),$("#subheader_text").hide(),$("#phone_verification_code").hide(),$("#common_button").hide(),$("#close").hide(),$(".modal-title").hide()):($("#message").css("display","block"),$("#message").html(data.message),$("#message").addClass(data.error))}))})),$(document).on("click",".form_submit",(function(){var classOfSubmit;if($("#common_button").hasClass("form_submit")){var pluginPhone=$("#phone").intlTelInput("getNumber"),pluginDefaultCountry=$("#phone").intlTelInput("getSelectedCountryData").iso2,pluginCarrierCode=$("#phone").intlTelInput("getSelectedCountryData").dialCode;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/add-phone-number",dataType:"json",cache:!1,data:{phone:pluginPhone,defaultCountry:pluginDefaultCountry,carrierCode:pluginCarrierCode}}).done((function(data){data.status&&($("#message").css("display","block"),$("#message").html(data.message),$("#message").addClass(data.class_name),$("#subheader_text").hide(),$("#common_button").hide(),$("#close").hide(),$(".phone_group").hide())}))}})),$("#editModal").on("hidden.bs.modal",(function(){""!=$("#edit_phone").val()&&($("#edit_phone").val(`+${OrginalUsercarrierCode}${OrginalUserphone}`),window.location.reload())})),$(document).ready((function(){$("#edit_phone").intlTelInput({separateDialCode:!0,nationalMode:!0,preferredCountries:["us"],autoPlaceholder:"polite",placeholderNumberType:"MOBILE",formatOnDisplay:!1,utilsScript:utilsScriptLoadingPath})})),$("#edit_phone").on("countrychange",(function(){if($("#edit_defaultCountry").val($("#edit_phone").intlTelInput("getSelectedCountryData").iso2),$("#edit_carrierCode").val($("#edit_phone").intlTelInput("getSelectedCountryData").dialCode),$.trim($(this).val()))if($(this).intlTelInput("isValidNumber")&&isValidPhoneNumber($.trim($(this).val()))){$("#edit-tel-number-error").html("");var id=$("#id").val();$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/duplicate-phone-number-check",dataType:"json",cache:!1,data:{phone:$.trim($(this).val()),carrierCode:$.trim($("#edit_phone").intlTelInput("getSelectedCountryData").dialCode),id:id}}).done((function(response){response.status?($("#edit-tel-number-error").html(""),$("#edit-phone-number-error").show(),$("#edit-phone-number-error").addClass("error").html(response.fail).css("font-weight","bold"),$("#common_button_update").prop("disabled",!0)):($("#edit-tel-number-error").show(),$("#edit-phone-number-error").html(""),$("#common_button_update").prop("disabled",!1))}))}else $("#edit-tel-number-error").addClass("error").html(validPhoneNumberErrorText).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),$("#common_button_update").prop("disabled",!0),$("#edit-phone-number-error").hide();else $("#edit-tel-number-error").html(""),$("#edit-phone-number-error").html(""),$("#common_button_update").prop("disabled",!1)})),$(document).ready((function(){$("#edit_phone").on("blur",(function(e){if($.trim($(this).val()))if($(this).intlTelInput("isValidNumber")&&isValidPhoneNumber($.trim($(this).val()))){var id=$("#user_id").val(),phone=$(this).val().replace(/-|\s/g,""),phone=$(this).val().replace(/^0+/,""),pluginCarrierCode=$(this).intlTelInput("getSelectedCountryData").dialCode;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/duplicate-phone-number-check",dataType:"json",cache:!1,data:{id:id,phone:phone,carrierCode:$.trim(pluginCarrierCode)}}).done((function(response){response.status?0==phone.length?$("#edit-phone-number-error").html(""):($("#edit-phone-number-error").addClass("error").html(response.fail).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),$("#common_button_update").prop("disabled",!0)):($("#common_button_update").prop("disabled",!1),$("#edit-phone-number-error").html(""))})),$("#edit-tel-number-error").html(""),$("#edit-phone-number-error").show(),$("#common_button_update").prop("disabled",!1)}else $("#edit-tel-number-error").addClass("error").html(validPhoneNumberErrorText).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),$("#common_button_update").prop("disabled",!0),$("#edit-phone-number-error").hide();else $("#edit-tel-number-error").html(""),$("#edit-phone-number-error").html(""),$("#common_button_update").prop("disabled",!1)}))})),$(document).on("click",".update",(function(){var phone=$("input[name=edit_phone]");if(""==phone.val())return $("#edit-phone-number-error").addClass("error").html(fieldRequiredText).css({color:"#f50000 !important","font-size":"14px","font-weight":"400","padding-top":"5px"}),!1;if(phone.hasClass("error"))return!1;$(".modal-title").html(getCodeText),$("#subheader_edit_text").html(verificationCodeText),$(".phone_group").hide(),$("#edit_static_phone_show").show(),$(".edit_button_edit").show(),$(this).removeClass("update").addClass("edit_get_code").html(getCodeText);var edit_phone=$("#edit_phone").intlTelInput("getNumber");return $("#edit_static_phone_show").html(edit_phone+"&nbsp;&nbsp;"),!0})),$(document).on("click",".edit_get_code",(function(){$(".modal-title").html(verifyPhoneText),$(this).removeClass("edit_get_code").addClass("edit_verify").html(verifyText),$(".phone_group").hide(),$(".edit_button_edit").hide(),$(".edit_static_phone_show").html(""),$("#subheader_edit_text").html(smsCodeSentText+"<br><br>"+smsCodeSubmitText),$("#edit_phone_verification_code").show().val("");var pluginPhone=$("#edit_phone").intlTelInput("getNumber"),pluginCarrierCode=$("#edit_phone").intlTelInput("getSelectedCountryData").dialCode;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/editGetVerificationCode",dataType:"json",cache:!1,data:{phone:pluginPhone,code:pluginCarrierCode}}).done((function(response){response.status&&$("#editHasVerificationCode").val(response.message)}))})),$(document).on("click",".edit_verify",(function(){var classOfSubmit=$("#common_button_update"),edit_phone_verification_code=$("#edit_phone_verification_code").val(),pluginPhone=$("#edit_phone").intlTelInput("getNumber"),pluginDefaultCountry=$("#edit_phone").intlTelInput("getSelectedCountryData").iso2,pluginCarrierCode=$("#edit_phone").intlTelInput("getSelectedCountryData").dialCode;classOfSubmit.hasClass("edit_verify")&&$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/edit-complete-phone-verification",dataType:"json",cache:!1,data:{phone:pluginPhone,flag:pluginDefaultCountry,code:pluginCarrierCode,edit_phone_verification_code:edit_phone_verification_code}}).done((function(data){data.status&&500!=data.status?($("#message").removeClass("alert-danger"),$("#message").css("display","block"),$("#message").html(data.message),$("#message").addClass(data.success),$("#subheader_edit_text").hide(),$("#edit_phone_verification_code").hide(),$("#common_button_update").hide(),$("#close").hide(),$(".modal-title").hide()):($("#message").css("display","block"),$("#message").html(data.message),$("#message").addClass(data.error))}))})),$(document).on("click",".edit_form_submit",(function(){var classOfSubmit;if($("#common_button_update").hasClass("edit_form_submit")){var pluginPhone=$("#edit_phone").intlTelInput("getNumber"),pluginDefaultCountry=$("#edit_phone").intlTelInput("getSelectedCountryData").iso2,pluginCarrierCode=$("#edit_phone").intlTelInput("getSelectedCountryData").dialCode;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:SITE_URL+"/profile/update-phone-number",dataType:"json",cache:!1,data:{phone:pluginPhone,flag:pluginDefaultCountry,code:pluginCarrierCode}}).done((function(data){data.status&&($("#message").css("display","block"),$("#message").html(data.message),$("#message").addClass(data.class_name),$("#subheader_edit_text").hide(),$("#common_button_update").hide(),$("#close").hide(),$(".phone_group").hide(),$(".modal-title").hide())}))}})),$("#file").change((function(){""!=$(this).val()&&upload(this)})),$("#reset_password").on("submit",(function(){$("#password-submit-btn").attr("disabled",!0),$(".spinner").removeClass("d-none"),$("#password-submit-btn-text").text(submittingText)})),$("#profile_update_form").on("submit",(function(){$("#users_profile").attr("disabled",!0),$(".spinner").removeClass("d-none"),$("#users_profile_text").text(submittingText)}))}