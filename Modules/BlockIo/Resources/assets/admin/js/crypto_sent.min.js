"use strict";function restrictNumberToPrefdecimalOnInput(e){var type=$("#network").data("type");restrictNumberToPrefdecimal(e,type)}if($(".content").find("#crypto-send-create").length){var merchantAddress,userAddress,amount,userId,priority="low",userAddressErrorFlag=!1,amountErrorFlag=!1;function checkSubmitBtn(){userAddressErrorFlag||amountErrorFlag?$("#admin-crypto-send-submit-btn").attr("disabled",!0):$("#admin-crypto-send-submit-btn").attr("disabled",!1)}function getMerchantAndUserNetworkAddressWithMerchantBalance(userId){$.ajax({url:addressBalanceUrl,type:"get",dataType:"json",data:{network:network,user_id:userId},beforeSend:function(){swal(pleaseWait,loading,{closeOnClickOutside:!1,closeOnEsc:!1,buttons:!1})}}).done((function(res){if(401==res.status)$(".amount-validation-error").text(res.message),userAddressErrorFlag=!0,amountErrorFlag=!0,checkSubmitBtn(),swal({title:errorText,text:res.message,icon:"error",closeOnClickOutside:!1,closeOnEsc:!1});else{$("#user-div").after(`<div class="form-group row" id="merchant-address-div">\n                    <label class="col-sm-3 control-label f-14 fw-bold text-end" for="merchant-address">${merchantCryptoAddress}</label>\n                    <div class="col-sm-6">\n                        <input type="text" class="form-control f-14" name="merchantAddress" id="merchant-address" value="${res.merchantAddress}"/>\n                    </div>\n                </div>`),$("#merchant-address-div").after(`<div class="form-group row" id="merchant-balance-div">\n                    <label class="col-sm-3 control-label f-14 fw-bold text-end" for="merchant-balance">${merchantCryptoBalance}</label>\n                    <div class="col-sm-6">\n                        <input type="text" class="form-control f-14" name="merchantBalance" id="merchant-balance" value="${res.merchantAddressBalance}"/>\n                    </div>\n                </div>`),$("#merchant-balance-div").after(`<div class="form-group row" id="user-address-div">\n                    <label class="col-sm-3 control-label f-14 fw-bold text-end" for="user-address">${userCryptoAddress}</label>\n                    <div class="col-sm-6">\n                        <input type="text" class="form-control f-14" name="userAddress" id="user-address" value="${res.userAddress}"/>\n                    </div>\n                </div>`);var previousCrytoSentUrl=window.localStorage.getItem("previousCrytoSentUrl"),cryptoSendAmount=window.localStorage.getItem("crypto-sent-amount"),previousPriority=window.localStorage.getItem("priority"),userId=window.localStorage.getItem("user_id");confirmationCryptoSentUrl==previousCrytoSentUrl&&null!=cryptoSendAmount?($("#user-address-div").after(`<div class="form-group row" id="amount-div">\n                        <label class="col-sm-3 control-label f-14 fw-bold text-end require" for="Amount">${cryptoSentAmount}</label>\n                        <div class="col-sm-6" id="amount-input-div">\n                            <input type="text" class="form-control f-14 amount" name="amount" placeholder="0.00000000" id="amount" value="${cryptoSendAmount}" onkeypress="return isNumberOrDecimalPointKey(this, event);" oninput="restrictNumberToPrefdecimalOnInput(this)" required data-value-missing="${requiredField}"/>\n                            <span class="amount-validation-error"></span>\n                        </div>\n                    </div>`),$("select#user_id option[value="+window.localStorage.getItem("user_id")+"]").prop("selected",!0),$("#select2-user_id-container").attr("title",$("select#user_id option:selected").text()).text($("select#user_id option:selected").text()),checkMerchantAmountValidity($(".amount").val().trim(),$("#merchant-address").val().trim(),$("#user-address").val().trim(),network,previousPriority),$("#admin-crypto-send-submit-btn").attr("disabled",!1),$(".fa-spin").hide(),$("#admin-crypto-send-submit-btn-text").html('Next&nbsp;<i class="fa fa-angle-right"></i>'),window.localStorage.removeItem("user_id"),window.localStorage.removeItem("crypto-sent-amount"),window.localStorage.removeItem("previousCrytoSentUrl"),window.localStorage.removeItem("priority")):$("#user-address-div").after(`<div class="form-group row" id="amount-div">\n                        <label class="col-sm-3 control-label f-14 fw-bold text-end require" for="Amount">${cryptoSentAmount}</label>\n                        <div class="col-sm-6" id="amount-input-div">\n                            <input type="text" class="form-control f-14 amount" name="amount" placeholder="0.00000000" id="amount" onkeypress="return isNumberOrDecimalPointKey(this, event);" oninput="restrictNumberToPrefdecimalOnInput(this)" required data-value-missing="${requiredField}"/>\n                            <span class="amount-validation-error"></span>\n                        </div>\n                    </div>`),$(".amount-validation-error").after(`<div class="clearfix"></div>\n                    <small class="form-text text-muted f-12 amount-hint"><b>*${cryptoTransactionText}</b></small><br/>\n                    <small class="form-text text-muted f-12"><b>*${minWithdrawan.replace(":x",blockIoMinLimit.amount[network]).replace(":y",network)}</b></small><br/>\n                    <small class="form-text text-muted f-12"><b>*${minNetworkFee.replace(":x",blockIoMinLimit.networkFee[network]).replace(":y",network)}</b></small><br/>\n                `),$("#amount-div").after(`\n                    <div class="form-group row" id="priority-div">\n                        <label class="col-sm-3 control-label f-14 fw-bold text-end" for="priority">${priorityText}</label>\n                        <div class="col-sm-6">\n                            <select class="form-control f-14" name="priority" id="priority">\n                                <option value="low">${low}</option>\n                                <option value="medium">${medium}</option>\n                                <option value="high">${high}</option>\n                            </select>\n                            <small class="form-text text-muted f-12 priority-hint"><b>*${networkFeeText}</b></small><br/>\n                            <small class="form-text text-muted f-12 important-text"><b>*${prioritySpecifyText}</b></small>\n                        </div>\n                    </div>\n                `),$("#priority-div").after(`<div class="form-group row" id="submit-anchor-div">\n                    <label class="col-sm-3"></label>\n                    <div class="col-sm-6">\n                        <a href="${backButtonUrl}" class="btn btn-theme-danger pull-left"><span><i class="fa fa-angle-left"></i>&nbsp;${backButton}</span></a>\n                        <button type="submit" class="btn btn-theme pull-right" id="admin-crypto-send-submit-btn">\n                            <i class="fa fa-spinner fa-spin d-none"></i>\n                            <span id="admin-crypto-send-submit-btn-text">${nextButton}&nbsp;<i class="fa fa-angle-right"></i></span>\n                        </button>\n                    </div>\n                </div>`),$("#merchant-address, #merchant-balance, #user-address").attr("readonly",!0),$(".amount-validation-error").text(""),userAddressErrorFlag=!1,amountErrorFlag=!1,checkSubmitBtn(),$("#priority").select2({}),$("#amount").focus();let currencyType=$("#network").data("type");"crypto"!=currencyType&&"crypto_asset"!=currencyType||$("#amount").attr("placeholder",CRYPTODP),swal.close()}})).fail((function(error){swal({title:errorText,text:JSON.parse(error.responseText).exception,icon:"error",closeOnClickOutside:!1,closeOnEsc:!1})}))}function checkMinimumAmount(message){$(".amount-validation-error").text(message),userAddressErrorFlag=!0,amountErrorFlag=!0,checkSubmitBtn()}function checkMerchantAmountValidity(amount,merchantAddress,userAddress,network,priority){amount<blockIoMinLimit.amount[network]?checkMinimumAmount(`${minAmount.replace(":x",blockIoMinLimit.amount[network]+" "+network)}`):($(".amount-validation-error").text(""),userAddressErrorFlag=!1,amountErrorFlag=!1,checkSubmitBtn(),$.ajax({method:"GET",url:validateBalanceUrl,dataType:"json",data:{network:network,amount:amount,merchantAddress:merchantAddress,userAddress:userAddress,priority:priority},beforeSend:function(){swal(pleaseWait,loading,{closeOnClickOutside:!1,closeOnEsc:!1,buttons:!1})}}).done((function(res){swal.close(),401==res.status&&($(".amount-validation-error").text(res.message),userAddressErrorFlag=!0,amountErrorFlag=!0,checkSubmitBtn())})).fail((function(error){alert(JSON.parse(error.responseText).exception)})))}function getPriority(priority){return priority="high"==priority?"high":"medium"==priority?"medium":"low"}$("#user_id").select2({}),$(window).on("load",(function(e){let userId=window.localStorage.getItem("user_id");userId&&getMerchantAndUserNetworkAddressWithMerchantBalance(userId)})),$(document).on("change","#user_id",(function(e){$("#merchant-address-div, #merchant-balance-div, #user-address-div, #amount-div, #submit-anchor-div, #priority-div").remove(),userId=$(this).val();let userName=$("#user_id option:selected").text();$(".user-full-name").text(userName),userId&&getMerchantAndUserNetworkAddressWithMerchantBalance(userId)})),$(document).on("keyup",".amount",$.debounce(900,(function(e){network=$("#network").val().trim(),merchantAddress=$("#merchant-address").val().trim(),userAddress=$("#user-address").val().trim(),amount=$(this).val().trim(),priority=getPriority($("#priority").val()),amount.length>0&&!isNaN(amount)?checkMerchantAmountValidity(amount,merchantAddress,userAddress,network,priority):($(".amount-validation-error").text(""),userAddressErrorFlag=!1,amountErrorFlag=!1,checkSubmitBtn())}))),$(document).on("change","#priority",(function(){network=$("#network").val(),merchantAddress=$("#merchant-address").val().trim(),userAddress=$("#user-address").val().trim(),amount=$(".amount").val().trim(),priority=getPriority($(this).val()),amount.length>0&&!isNaN(amount)?checkMerchantAmountValidity(amount,merchantAddress,userAddress,network,priority):($(".amount-validation-error").text(""),userAddressErrorFlag=!1,amountErrorFlag=!1,checkSubmitBtn())})),$(document).on("submit","#admin-crypto-send-form",(function(){window.localStorage.setItem("user_id",$("#user_id").val()),window.localStorage.setItem("crypto-sent-amount",$(".amount").val().trim()),window.localStorage.setItem("priority",$("#priority").val()),$("#admin-crypto-send-submit-btn").attr("disabled",!0),$(".fa-spinner").removeClass("d-none"),$("#admin-crypto-send-submit-btn-text").text(sending),setTimeout((function(){$(".fa-spinner").addClass("d-none"),$("#admin-crypto-send-submit-btn").attr("disabled",!1),$("#admin-crypto-send-submit-btn-text").text(send)}),1e4)}))}if($(".content").find("#crypto-send-confirm").length){function cryptoSendConfirmBack(){window.localStorage.setItem("previousCrytoSentUrl",document.URL),window.location.replace(cryptoSendBackConfirmUrl)}$(document).on("click",".admin-user-crypto-send-confirm-back-btn",(function(e){e.preventDefault(),cryptoSendConfirmBack()})),$(document).on("submit","#admin-user-crypto-send-confirm",(function(){window.localStorage.removeItem("crypto-sent-amount"),window.localStorage.removeItem("previousCrytoSentUrl"),window.localStorage.removeItem("user_id"),window.localStorage.removeItem("priority"),$("#admin-user-crypto-send-confirm-btn").attr("disabled",!0),$(".fa-spinner").removeClass("d-none"),$("#admin-user-crypto-send-confirm-btn-text").text(confirming),$(".admin-user-crypto-send-confirm-back-btn").attr("disabled",!0).click((function(e){e.preventDefault()})),$(".admin-user-crypto-send-confirm-back-link").click((function(e){e.preventDefault()})),setTimeout((function(){$(".fa-spinner").addClass("d-none"),$("#admin-user-crypto-send-confirm-btn").attr("disabled",!1),$("#admin-user-crypto-send-confirm-btn-text").text(confirm)}),1e4)}))}